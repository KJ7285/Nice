local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/Mc4121ban/Linoria-Library-Mobile/refs/heads/main/Gui%20Lib%20%5BLibrary%5D"))()
local ThemeManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/KJ7285/Theme-manger-/refs/heads/main/ThemeManager.Lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/Mc4121ban/Linoria-Library-Mobile/refs/heads/main/Gui%20Lib%20%5BSaveManager%5D"))()
local Window = Library:CreateWindow({Title='[MoonLight]ðŸŒ™',Center=true,AutoShow=true,TabPadding=8,MenuFadeTime=0.2,Size=UDim2.new(0,450,0,450)})
local Tabs={Main=Window:AddTab('Main'),Misc=Window:AddTab('Misc'),['UI Settings']=Window:AddTab('UI Settings')}
local predX,predY=0.13946352838245239,0.075
local camEnabled,lockEnabled=false,false
local targetPlayer,targetUserId=nil,nil
local waitingForRejoin=false
local connRender,currentHighlight=nil,nil
local wallCheckEnabled,friendCheckEnabled,koCheckEnabled=false,false,false
local autoAirEnabled,prevInAir=false,false
local autoArmorEnabled,autoReloadEnabled=false,false
local silentAim={isActive=false,targetPart="HumanoidRootPart",prediction=0.165}
local r15Parts={"HumanoidRootPart","LowerTorso","UpperTorso","Head","LeftUpperArm","LeftLowerArm","LeftHand","RightUpperArm","RightLowerArm","RightHand","LeftUpperLeg","LeftLowerLeg","LeftFoot","RightUpperLeg","RightLowerLeg","RightFoot"}
local mainGroup=Tabs.Main:AddLeftGroupbox('CamLock Settings')
mainGroup:AddToggle('Cam',{Text='CamLock',Default=false,Tooltip='Enable camera lock',Callback=function(v)camEnabled=v end})
mainGroup:AddToggle('Lock',{Text='Lock',Default=false,Tooltip='Enable silent lock',Callback=function(v)lockEnabled=v silentAim.isActive=v if not v then targetPlayer=nil end end})
mainGroup:AddInput('PredX',{Text='Cam Pred X',Default=tostring(predX),Numeric=true,Placeholder='e.g. 0.139',Callback=function(val)predX=tonumber(val) or predX end})
mainGroup:AddInput('PredY',{Text='Cam Pred Y',Default=tostring(predY),Numeric=true,Placeholder='e.g. 0.075',Callback=function(val)predY=tonumber(val) or predY end})
mainGroup:AddInput('HookPred',{Text='Lock Pred',Default=tostring(silentAim.prediction),Numeric=true,Placeholder='e.g. 0.165',Callback=function(val)silentAim.prediction=tonumber(val) or silentAim.prediction end})
mainGroup:AddDropdown('AimPartDropdown',{Values=r15Parts,Default=1,Text='AimPart',Tooltip='Part for cam/lock on ground',Callback=function(val)silentAim.targetPart=val end})
mainGroup:AddDropdown('AirPartDropdown',{Values=r15Parts,Default=1,Text='AirPart',Tooltip='Part for cam/lock in air',Callback=function(val)end})
local highlightPicker=mainGroup:AddLabel('Highlight Color'):AddColorPicker('HighlightColor',{Default=Color3.new(1,0,0),Title='Highlight Color',Transparency=0,Callback=function(val)end})
mainGroup:AddToggle('WallCheck',{Text='WallCheck',Default=false,Tooltip='Skip blocked targets',Callback=function(v)wallCheckEnabled=v end})
mainGroup:AddToggle('FriendCheck',{Text='FriendCheck',Default=false,Tooltip='Skip friends',Callback=function(v)friendCheckEnabled=v end})
mainGroup:AddToggle('KoCheck',{Text='KoCheck',Default=false,Tooltip='Skip knocked targets',Callback=function(v)koCheckEnabled=v end})
mainGroup:AddToggle('AutoAir',{Text='AutoAir',Default=false,Tooltip='Activate tool when target in air',Callback=function(v)autoAirEnabled=v end})
local miscGroup=Tabs.Misc:AddLeftGroupbox('Misc Settings')
miscGroup:AddToggle('AutoArmor',{Text='Auto Armor',Default=false,Tooltip='Spam armor pad',Callback=function(v)autoArmorEnabled=v end})
miscGroup:AddToggle('AutoReload',{Text='Auto Reload',Default=false,Tooltip='Auto reload when ammo hits zero',Callback=function(v)autoReloadEnabled=v end})
ThemeManager:SetLibrary(Library)
SaveManager:SetLibrary(Library)
SaveManager:IgnoreThemeSettings()
ThemeManager:SetFolder('MoonLight')
SaveManager:SetFolder('MoonLight/specific-game')
SaveManager:BuildConfigSection(Tabs['UI Settings'])
ThemeManager:ApplyToTab(Tabs['UI Settings'])
SaveManager:LoadAutoloadConfig()
local Players=game:GetService("Players")
local LocalPlayer=Players.LocalPlayer
local RunService=game:GetService("RunService")
local UserInputService=game:GetService("UserInputService")
local cam=workspace.CurrentCamera
local screenGui=Instance.new("ScreenGui",game:GetService("CoreGui"))
screenGui.Name="CamLockGui"
screenGui.ResetOnSpawn=false
local btn=Instance.new("TextButton",screenGui)
btn.Size=UDim2.new(0,90,0,90)
btn.Position=UDim2.new(0,10,0,100)
btn.AnchorPoint=Vector2.new(0,0)
btn.BackgroundTransparency=0.3
btn.BackgroundColor3=Color3.new(0,0,0)
btn.BorderSizePixel=0
btn.Text="ðŸ”“"
btn.TextScaled=true
Instance.new("UICorner",btn).CornerRadius=UDim.new(0,9)
do
 local ft,fc,fps=tick(),0,60
 RunService.RenderStepped:Connect(function()
  fc+=1
  if tick()-ft>=1 then fps=fc fc=0 ft=tick() end
  Library:SetWatermark(('MoonLight ðŸŒ™ | %s fps'):format(math.floor(fps)))
 end)
end
local function destroyHighlight()
 if currentHighlight then currentHighlight:Destroy() currentHighlight=nil end
end
local function applyHighlight(char)
 destroyHighlight()
 local h=Instance.new("Highlight")
 h.Adornee=char
 h.FillTransparency=0.5
 h.OutlineTransparency=0
 h.OutlineColor=highlightPicker.Value or Color3.new(1,0,0)
 h.Parent=char
 currentHighlight=h
end
local function raycastBlock(o,p)
 local params=RaycastParams.new()
 params.FilterType=Enum.RaycastFilterType.Blacklist
 params.FilterDescendantsInstances={LocalPlayer.Character}
 if targetPlayer and targetPlayer.Character then table.insert(params.FilterDescendantsInstances,targetPlayer.Character) end
 return workspace:Raycast(o,p-o,params)~=nil
end
local function stopLock()
 if connRender then connRender:Disconnect() connRender=nil end
 destroyHighlight()
 targetPlayer=nil
 targetUserId=nil
 waitingForRejoin=false
 prevInAir=false
 silentAim.isActive=false
 btn.Text="ðŸ”“"
 Library:Notify("Unlocked ðŸ¤˜")
end
local function startRenderSteppedLock(pl)
 if connRender then connRender:Disconnect() end
 connRender=RunService.RenderStepped:Connect(function()
  if not(camEnabled or lockEnabled) or not targetPlayer then stopLock() return end
  local char=targetPlayer.Character
  if not char or (char:FindFirstChild("Humanoid")or{Health=0}).Health<=0 then waitingForRejoin=true return end
  if koCheckEnabled and char:GetAttribute("Knocked") then stopLock() return end
  local humanoid=char:FindFirstChild("Humanoid")
  local inAir=humanoid and humanoid.FloorMaterial==Enum.Material.Air
  if inAir and autoAirEnabled and not prevInAir then prevInAir=true task.delay(0.2,function() local tool=LocalPlayer.Character:FindFirstChildOfClass("Tool") if tool then tool:Activate() end end)
  elseif not inAir then prevInAir=false end
  local partName=inAir and airDropdown.Value or aimDropdown.Value
  local root=char:FindFirstChild(partName)
  if not root then waitingForRejoin=true return end
  waitingForRejoin=false
  applyHighlight(char)
  if camEnabled then local v=root.Velocity local fo=v.Y<0 and -0.27 or 0 local off=Vector3.new(v.X*predX,v.Y*predY+fo,v.Z*predX) cam.CFrame=CFrame.new(cam.CFrame.Position,root.Position+off) end
  if lockEnabled then silentAim.isActive=true end
 end)
end
local function attemptLockOn(pl)
 if not(camEnabled or lockEnabled) then Library:Notify("Enable CamLock or Lock first ðŸ¤¨") return end
 if friendCheckEnabled and LocalPlayer:IsFriendsWith(pl.UserId) then Library:Notify("Skipping friend "..pl.Name) return end
 if wallCheckEnabled then local root=pl.Character and pl.Character:FindFirstChild(aimDropdown.Value) if root and raycastBlock(cam.CFrame.Position,root.Position) then Library:Notify("Blocked by wall, skipping "..pl.Name) return end end
 targetPlayer=pl
 targetUserId=pl.UserId
 prevInAir=false
 silentAim.isActive=lockEnabled
 btn.Text="ðŸ”’"
 Library:Notify("Locked in "..pl.Name)
 startRenderSteppedLock(pl)
end
do
 local dragging=false; local di,ds,sp
 btn.InputBegan:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 or i.UserInputType==Enum.UserInputType.Touch then dragging=true ds=i.Position sp=btn.Position i.Changed:Connect(function() if i.UserInputState==Enum.UserInputState.End then dragging=false end end) end end)
 btn.InputChanged:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseMovement or i.UserInputType==Enum.UserInputType.Touch then di=i end end)
 UserInputService.InputChanged:Connect(function(i) if dragging and i==di then local d=i.Position-ds btn.Position=UDim2.new(sp.X.Scale,sp.X.Offset+d.X,sp.Y.Scale,sp.Y.Offset+d.Y) end end)
end
btn.MouseButton1Click:Connect(function()
 if targetPlayer then local c=targetPlayer.Character local h=c and c:FindFirstChild("Humanoid") if c and h and h.Health>0 then stopLock() return end end
 local closest,minD=nil,math.huge
 for _,pl in ipairs(Players:GetPlayers()) do
  if pl~=LocalPlayer and pl.Character and pl.Character:FindFirstChild("HumanoidRootPart") then
   local h=pl.Character:FindFirstChild("Humanoid") if h and h.Health>0 then
    if friendCheckEnabled and LocalPlayer:IsFriendsWith(pl.UserId) then continue end
    local root=pl.Character:FindFirstChild(aimDropdown.Value) or pl.Character.HumanoidRootPart
    if root then local sp,vis=cam:WorldToViewportPoint(root.Position) if vis then local dx,dy=sp.X-cam.ViewportSize.X/2,sp.Y-cam.ViewportSize.Y/2 local d=math.sqrt(dx*dx+dy*dy) if d<minD then minD,closest=d,pl end end end
   end
  end
 end
 if closest then attemptLockOn(closest) else Library:Notify("No valid target found ðŸ¤·â€â™‚ï¸") end
end)
Players.PlayerRemoving:Connect(function(pl) if targetPlayer==pl then waitingForRejoin=true end end)
Players.PlayerAdded:Connect(function(pl) if waitingForRejoin and pl.UserId==targetUserId then pl.CharacterAdded:Connect(function(c) if(camEnabled or lockEnabled)and pl.UserId==targetUserId then task.wait(0.5) if c:FindFirstChild("HumanoidRootPart") then targetPlayer=pl startRenderSteppedLock(pl) Library:Notify("Re-locked "..pl.Name) end end end) end end)
task.spawn(function() while task.wait(0.1) do if autoArmorEnabled then local pad=workspace:FindFirstChild("MAP")and workspace.MAP.Pads:FindFirstChild("[Medium Armor]") if pad and pad:FindFirstChild("ClickDetector") then fireclickdetector(pad.ClickDetector) end end end end)
local function setupAmmoWatcher(tool) if not tool or not tool:IsA("Tool") then return end local ammo=tool:FindFirstChild("AMMO") if ammo and not ammo:GetAttribute("WatcherConnected") then ammo:SetAttribute("WatcherConnected",true) ammo.Changed:Connect(function() if autoReloadEnabled and ammo.Value<=0 then if tool:FindFirstChild("rl") then tool.rl:FireServer() end end end) end end
Players.LocalPlayer.CharacterAdded:Connect(function(c) c.ChildAdded:Connect(setupAmmoWatcher) for _,v in ipairs(c:GetChildren())do setupAmmoWatcher(v)end end)
for _,v in ipairs(LocalPlayer.Backpack:GetChildren())do setupAmmoWatcher(v)end
LocalPlayer.Backpack.ChildAdded:Connect(setupAmmoWatcher)
game:GetService("StarterGui"):SetCore("SendNotification",{Title="MoonLight Loaded",Text="Enjoy ðŸŒ™"})
do
 local mt=getrawmetatable(game)
 local oldNI=mt.__newindex
 setreadonly(mt,false)
 mt.__newindex=newcclosure(function(self,k,v) if not checkcaller() and self:IsA("Humanoid") and k=="JumpPower" then return end return oldNI(self,k,v) end)
 setreadonly(mt,true)
end
do
 local mt=getrawmetatable(game)
 local oldNC=mt.__namecall
 setreadonly(mt,false)
 local methods={"UpdateMousePos","GetMousePos","MousePos","MOUSE","MousePosUpdate","UpdateMousePosI"}
 mt.__namecall=newcclosure(function(...)
  local args={...}
  if silentAim.isActive and targetPlayer and targetPlayer.Character and getnamecallmethod()=="FireServer" then
   for _,m in ipairs(methods)do
    if args[2]==m then
     local p=targetPlayer.Character:FindFirstChild(silentAim.targetPart)
     if p then local v=p.Velocity local fo=v.Y<0 and -0.27 or 0 args[3]=p.Position+(v*silentAim.prediction)+Vector3.new(0,fo,0) end
     break
    end
   end
  end
  return oldNC(table.unpack(args))
 end)
 setreadonly(mt,true)
end
